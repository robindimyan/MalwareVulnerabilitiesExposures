# Malware Description
Hackarmy is a botnet client which communicates its C2 over IRC protocol. It receive it commands through private messages but first you would need to send it a passphrase in order to command.

# MVE-2019-001: Denial of Service
You may crash any client with a single private message without the need of any authentication. This vulnerability has its roots in IRC parsing function.

## Demo
You can watch the demo here: https://youtu.be/952tJ8oDlgE

Exploit: **/PRIVMSG client_username loldie**

## Technical Details
Bug is caused by the custom IRC parser of this malware. When it parses PRIVMSG commands it first tries to locate " :" inside the string with strstr function.
Then it goes 2 bytes beyond the address returned, in order to reach to starting point of the message, and then it attempts to read it.
While doing these the malware is assuming that PRIVMSG command will indeed contain " :" because that is how it is defined in RFC.
But IRC servers are not bound to comply with that as in this case. When you send a PRIVMSG command to a client without a " :" it makes the client crash.

### Vulnerable Code
![](https://i.ibb.co/88bR01Q/1.png)

### Crash
![](https://i.ibb.co/5FG9BmF/3.png)
![](https://i.ibb.co/8Xgg4wD/2.png)
